sudo dnf update -y
sudo dnf install httpd nginx php php-mysqlnd python3 python3-pip mariadb-server -y
#edit apache
sudo vim /etc/httpd/conf/httpd.conf
Listen 8080
#Start and enable Apache
sudo systemctl enable httpd
sudo systemctl start httpd
sudo systemctl status httpd
#Verify Apache is running on port 8080
sudo ss -tuln | grep 8080

#Configure Nginx as reverse proxy on port 80
sudo vim /etc/nginx/conf.d/reverse-proxy.conf

server {
    listen 80;
    server_name 192.168.1.1;

    location /flask/ {
        proxy_pass http://127.0.0.1:5000/;
    }

    location /php/ {
        proxy_pass http://127.0.0.1:8080/;
    }
}

mysql -u root -p
CREATE DATABASE testdb;
SHOW DATABASES;

USE testdb;


CREATE TABLE students (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50),
    course VARCHAR(50)
);

INSERT INTO students (name, course) VALUES
('Alice', 'Operating Systems'),
('Bob', 'Digital Systems'),
('Cathy', 'Software Engineering');

SELECT * FROM students;

EXIT;

mysql -u root -p -e "SELECT * FROM students LIMIT 10;" testdb
















#) Start and enable Nginx
sudo systemctl enable nginx
sudo systemctl start nginx
sudo systemctl status nginx
#curl http://192.168.1.1
#Install & Configure PHP
echo "<?php phpinfo(); ?>" | sudo tee /var/www/html/info.php
#http://192.168.1.1/info.php
#After you test PHP and confirm itâ€™s working, delete the file:
sudo rm /var/www/html/info.php


#Deploy a Python Flask app
pip3 install flask
mkdir -p /var/www/flaskapp
cd /var/www/flaskapp
sudo vim app.py
from flask import Flask
app = Flask(__name__)

@app.route('/')
def home():
    return "Hello from Flask on openEuler!"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
python3 app.py
sudo firewall-cmd --permanent --add-port=5000/tcp
sudo firewall-cmd --reload

#Install and configure MariaDB (MySQL database)
sudo systemctl enable mariadb
sudo systemctl start mariadb
sudo mysql_secure_installation
sudo mysql -u root -p
CREATE DATABASE myappdb;
CREATE USER 'appuser'@'%' IDENTIFIED BY 'password123';
GRANT ALL PRIVILEGES ON myappdb.* TO 'appuser'@'%';
FLUSH PRIVILEGES;
EXIT;
sudo vim /etc/my.cnf.d/mariadb-server.cnf
# bind-address=127.0.0.1
>>  sudo systemctl restart mariadb

#Configure Nginx for HTTPS
sudo dnf install -y openssl

#Edit /etc/nginx/conf.d/projecta.conf:
sudo cp /etc/nginx/nginx.conf /etc/nginx/conf.d/wordpress.conf

#edit /etc/nginx/conf.d/wordpress.conf
server {
    listen 80;
    server_name projecta.local;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name loaclhost;

     ssl_certificate /etc/nginx/ssl/cert.pem;
     ssl_certificate_key /etc/nginx/ssl/key.pem;

root /var/ProjectA;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ =404;
    }

}
sudo systemctl reload nginx

openssl req -x509 -nodes -newkey rsa:4096 -keyout key.pem -out cert.pem -sha256 -days 365
sudo mkdir /etc/nginx/ssl
sudo cp *.pem /etc/nginx/ssl
sudo chmod 755 /etc/nginx/ssl
sudo chmod 755 /etc/nginx/ssl/*


#wordpress
cd /var/www/html
sudo wget https://wordpress.org/latest.zip
sudo unzip latest.zip
sudo mv wordpress/* .
sudo chown -R apache:apache /var/www/html
sudo chmod -R 755 /var/www/html
